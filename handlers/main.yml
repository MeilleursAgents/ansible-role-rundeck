---
# handlers file for rundeck
- name: start rundeck
  service:
    name: rundeck
    state: started

- name: unpack rundeck
  command: java -jar {{ rundeck_rdeckbase }}/rundeck-launcher-{{ rundeck_version }}.jar --installonly

- name: restart rundeck
  service:
    name: rundeck
    state: restarted
  when:
    - ansible_virtualization_type != "docker"

- name: systemd daemon reload
  systemd:
    daemon_reload: yes

- name: configure rundeck framework
  lineinfile:
    dest: "{{ rundeck_rdeckbase }}/etc/framework.properties"
    line: "{{ item.parameter }} = {{ item.value }}"
    regexp: "^{{ item.parameter }}"
  notify: restart rundeck
  with_items:
    - "{{ rundeck_framework }}"
